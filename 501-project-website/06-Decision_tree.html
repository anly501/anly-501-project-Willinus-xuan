<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.2.247">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Haoxuan(Will) Weng">

    <title>decision-tree</title>
    <link rel="stylesheet" href="./project.css">
    <style>
        code {
            white-space: pre-wrap;
        }
        
        span.smallcaps {
            font-variant: small-caps;
        }
        
        div.columns {
            display: flex;
            gap: min(4vw, 1.5em);
        }
        
        div.column {
            flex: auto;
            overflow-x: auto;
        }
        
        div.hanging-indent {
            margin-left: 1.5em;
            text-indent: -1.5em;
        }
        
        ul.task-list {
            list-style: none;
        }
        
        ul.task-list li input[type="checkbox"] {
            width: 0.8em;
            margin: 0 0.8em 0.2em -1.6em;
            vertical-align: middle;
        }
        
        pre>code.sourceCode {
            white-space: pre;
            position: relative;
        }
        
        pre>code.sourceCode>span {
            display: inline-block;
            line-height: 1.25;
        }
        
        pre>code.sourceCode>span:empty {
            height: 1.2em;
        }
        
        .sourceCode {
            overflow: visible;
        }
        
        code.sourceCode>span {
            color: inherit;
            text-decoration: inherit;
        }
        
        div.sourceCode {
            margin: 1em 0;
        }
        
        pre.sourceCode {
            margin: 0;
        }
        
        @media screen {
            div.sourceCode {
                overflow: auto;
            }
        }
        
        @media print {
            pre>code.sourceCode {
                white-space: pre-wrap;
            }
            pre>code.sourceCode>span {
                text-indent: -5em;
                padding-left: 5em;
            }
        }
        
        pre.numberSource code {
            counter-reset: source-line 0;
        }
        
        pre.numberSource code>span {
            position: relative;
            left: -4em;
            counter-increment: source-line;
        }
        
        pre.numberSource code>span>a:first-child::before {
            content: counter(source-line);
            position: relative;
            left: -1em;
            text-align: right;
            vertical-align: baseline;
            border: none;
            display: inline-block;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            padding: 0 4px;
            width: 4em;
            color: #aaaaaa;
        }
        
        pre.numberSource {
            margin-left: 3em;
            border-left: 1px solid #aaaaaa;
            padding-left: 4px;
        }
        
        div.sourceCode {}
        
        @media screen {
            pre>code.sourceCode>span>a:first-child::before {
                text-decoration: underline;
            }
        }
        
        code span.al {
            color: #ff0000;
            font-weight: bold;
        }
        /* Alert */
        
        code span.an {
            color: #60a0b0;
            font-weight: bold;
            font-style: italic;
        }
        /* Annotation */
        
        code span.at {
            color: #7d9029;
        }
        /* Attribute */
        
        code span.bn {
            color: #40a070;
        }
        /* BaseN */
        
        code span.bu {
            color: #008000;
        }
        /* BuiltIn */
        
        code span.cf {
            color: #007020;
            font-weight: bold;
        }
        /* ControlFlow */
        
        code span.ch {
            color: #4070a0;
        }
        /* Char */
        
        code span.cn {
            color: #880000;
        }
        /* Constant */
        
        code span.co {
            color: #60a0b0;
            font-style: italic;
        }
        /* Comment */
        
        code span.cv {
            color: #60a0b0;
            font-weight: bold;
            font-style: italic;
        }
        /* CommentVar */
        
        code span.do {
            color: #ba2121;
            font-style: italic;
        }
        /* Documentation */
        
        code span.dt {
            color: #902000;
        }
        /* DataType */
        
        code span.dv {
            color: #40a070;
        }
        /* DecVal */
        
        code span.er {
            color: #ff0000;
            font-weight: bold;
        }
        /* Error */
        
        code span.ex {}
        /* Extension */
        
        code span.fl {
            color: #40a070;
        }
        /* Float */
        
        code span.fu {
            color: #06287e;
        }
        /* Function */
        
        code span.im {
            color: #008000;
            font-weight: bold;
        }
        /* Import */
        
        code span.in {
            color: #60a0b0;
            font-weight: bold;
            font-style: italic;
        }
        /* Information */
        
        code span.kw {
            color: #007020;
            font-weight: bold;
        }
        /* Keyword */
        
        code span.op {
            color: #666666;
        }
        /* Operator */
        
        code span.ot {
            color: #007020;
        }
        /* Other */
        
        code span.pp {
            color: #bc7a00;
        }
        /* Preprocessor */
        
        code span.sc {
            color: #4070a0;
        }
        /* SpecialChar */
        
        code span.ss {
            color: #bb6688;
        }
        /* SpecialString */
        
        code span.st {
            color: #4070a0;
        }
        /* String */
        
        code span.va {
            color: #19177c;
        }
        /* Variable */
        
        code span.vs {
            color: #4070a0;
        }
        /* VerbatimString */
        
        code span.wa {
            color: #60a0b0;
            font-weight: bold;
            font-style: italic;
        }
        /* Warning */
    </style>


    <script src="Decision Tree_files/libs/clipboard/clipboard.min.js"></script>
    <script src="Decision Tree_files/libs/quarto-html/quarto.js"></script>
    <script src="Decision Tree_files/libs/quarto-html/popper.min.js"></script>
    <script src="Decision Tree_files/libs/quarto-html/tippy.umd.min.js"></script>
    <script src="Decision Tree_files/libs/quarto-html/anchor.min.js"></script>
    <link href="Decision Tree_files/libs/quarto-html/tippy.css" rel="stylesheet">
    <link href="Decision Tree_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
    <script src="Decision Tree_files/libs/bootstrap/bootstrap.min.js"></script>
    <link href="Decision Tree_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
    <link href="Decision Tree_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
    <script type="application/javascript">
        define('jquery', [], function() {
            return window.jQuery;
        })
    </script>


</head>

<body>
    <header>
        <div class="su-brand-bar su-brand-bar--default">
            <div class="header-container">
                <div class="header-leftside">
                    <a class="su-brand-bar__logo" href="https://www.georgetown.edu/">Georgetown University</a>
                </div>

                <div class="header-rightside">
                    <a class="su-brand-bar__logo" href="http://haoxuan-weng.georgetown.domains/501-project-website/index.html">
                Home
            </a>
                    <a class="su-brand-bar__logo code" href="https://github.com/anly501/anly-501-project-Willinus-xuan">
                Code
            </a>
                    <a class="su-brand-bar__logo code" href="https://github.com/anly501/anly-501-project-Willinus-xuan">
                Data
            </a>
                </div>
            </div>
        </div>
    </header>

    <section class="banner">
        <div class="content-container">
            <div class='research-name'>
                <h1>
                    Automatic Cyberbulleying detect
                </h1>
            </div>
            <div class="subject">
                ANLY 501 Data Science and Analytics
            </div>
        </div>
    </section>

    <section class="wrapper">
        <div style="position:sticky;top: 300px;float: left;max-width: 25%;">
            <nav class="bx--tableofcontents__desktop" data-autoid="dds--tableofcontents__desktop">
                <ul>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/01-introduction.html">About this project</a></li>
                    <li class="bx--tableofcontents__desktop__item bx--tableofcontents__desktop__item--active"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/02-data_collection.html" aria-current="location">Data collection</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/03-data_cleaning.html">Data Cleaning</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/04-data_exploring.html">Exploring Data</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/05-Naive_Bayes.html">Naïve Bayes</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/06-Decision_tree.html">Decision Trees</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/07-svm.html">SVM</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/08-clustering_analysis.html">Clustering</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/09-network_analysis.html">ARM and Networking</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/10-conclusion.html">Conclusions</a></li>
                </ul>
            </nav>
        </div>
    </section>

    <div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
        <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
            <nav id="TOC" role="doc-toc" class="toc-active">
                <h2 id="toc-title">Table of contents</h2>

                <ul>
                    <li><a href="#method" id="toc-method" class="nav-link active" data-scroll-target="#method"><span class="toc-section-number">1</span>  Method</a></li>
                    <li><a href="#class-distribution" id="toc-class-distribution" class="nav-link" data-scroll-target="#class-distribution"><span class="toc-section-number">2</span>  Class Distribution</a></li>
                    <li><a href="#baseline-model-for-comparison" id="toc-baseline-model-for-comparison" class="nav-link" data-scroll-target="#baseline-model-for-comparison"><span class="toc-section-number">3</span>  Baseline model for comparison</a></li>
                    <li><a href="#feature-selection" id="toc-feature-selection" class="nav-link" data-scroll-target="#feature-selection"><span class="toc-section-number">4</span>  Feature Selection</a></li>
                    <li><a href="#model-tuning" id="toc-model-tuning" class="nav-link" data-scroll-target="#model-tuning"><span class="toc-section-number">5</span>  Model Tuning</a></li>
                    <li><a href="#final-results" id="toc-final-results" class="nav-link" data-scroll-target="#final-results"><span class="toc-section-number">6</span>  Final Results</a></li>
                    <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="toc-section-number">7</span>  Conclusion</a></li>
                </ul>
            </nav>
        </div>
        <main class="content" id="quarto-document-content">



            <section id="method" class="level1" data-number="1">
                <h1 data-number="1"><span class="header-section-number">1</span> Method</h1>
                <p>A <strong><em>decision</em></strong> tree is a type of supervised machine learning used to categorize or make predictions based on how a previous set of questions were answered. The model is a form of supervised learning, meaning that
                    the model is trained and tested on a set of data that contains the desired categorization.</p>
                <p>A decision tree resembles, well, a tree. The base of the tree is the root node. From the root node flows a series of decision nodes that depict decisions to be made. From the decision nodes are leaf nodes that represent the consequences
                    of those decisions. Each decision node represents a question or split point, and the leaf nodes that stem from a decision node represent the possible answers. Leaf nodes sprout from decision nodes similar to how a leaf sprouts on a
                    tree branch. This is why we call each subsection of a decision tree a “branch.” Let’s take a look at an example for this. You’re a golfer, and a consistent one at that. On any given day you want to predict where your score will be
                    in two buckets: below par or over par.</p>
                <p>In this tab, since the simplexity and flexibility of Decision Tree, text data are leveraged with this classificaiton model, to predict the cyberviolence in the text</p>
                <p><img src="https://s2.loli.net/2022/10/29/bqhYlN2ACQOs7d6.png"></p>
                <div class="cell" data-execution_count="22">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import the libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfTransformer</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> recall_score</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> f1_score</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_recall_fscore_support</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>

            </section>
            <section id="class-distribution" class="level1" data-number="2">
                <h1 data-number="2"><span class="header-section-number">2</span> Class Distribution</h1>
                <div class="cell" data-execution_count="24">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the csv file</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'../../data/hate_speech.csv'</span>,index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># delete null text</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>df.text <span class="op">=</span> df.text.fillna(<span class="st">''</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[<span class="op">~</span>df[<span class="st">'text'</span>].isnull()]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-display" data-execution_count="24">

                        <div>

                            <table class="dataframe table table-sm table-striped">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>id</th>
                                        <th>follower_count</th>
                                        <th>friends_count</th>
                                        <th>retweet_count</th>
                                        <th>favorite_count</th>
                                        <th>text</th>
                                        <th>word_length</th>
                                        <th>label</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th>0</th>
                                        <td>13857342</td>
                                        <td>20161</td>
                                        <td>780</td>
                                        <td>0</td>
                                        <td>0</td>
                                        <td>trying least targeting specific group cause tr...</td>
                                        <td>10</td>
                                        <td>0</td>
                                    </tr>
                                    <tr>
                                        <th>1</th>
                                        <td>13857342</td>
                                        <td>20161</td>
                                        <td>780</td>
                                        <td>0</td>
                                        <td>4</td>
                                        <td>saw fly stats display time tweetstats hashtag ...</td>
                                        <td>13</td>
                                        <td>0</td>
                                    </tr>
                                    <tr>
                                        <th>2</th>
                                        <td>82522377</td>
                                        <td>4</td>
                                        <td>64</td>
                                        <td>0</td>
                                        <td>1</td>
                                        <td>sauce capsicum stock packet jar quality cookin...</td>
                                        <td>15</td>
                                        <td>1</td>
                                    </tr>
                                    <tr>
                                        <th>3</th>
                                        <td>13857342</td>
                                        <td>20161</td>
                                        <td>780</td>
                                        <td>1</td>
                                        <td>30</td>
                                        <td>think going play video game day super stressfu...</td>
                                        <td>11</td>
                                        <td>0</td>
                                    </tr>
                                    <tr>
                                        <th>4</th>
                                        <td>930620467</td>
                                        <td>18807</td>
                                        <td>263</td>
                                        <td>0</td>
                                        <td>0</td>
                                        <td>fight systemic problem time offering real tip ...</td>
                                        <td>11</td>
                                        <td>0</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="cell" data-execution_count="25">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the distribution</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.hist(df.label.astype(<span class="st">'string'</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"The distribution of the class"</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Class"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Counts"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-display" data-execution_count="25">
                        <pre><code>Text(0, 0.5, 'Counts')</code></pre>
                    </div>
                    <div class="cell-output cell-output-display">
                        <p><img src="Decision%20Tree_files/figure-html/cell-5-output-2.png" class="img-fluid"></p>
                    </div>
                </div>
                <p>The counts of the two classes are imblanced. The labels are binary value. For the decision tree, it is not largely influenced by the imbalanced dataset property. In order to maintain the original imblanced distribution of the two classes,
                    the dataset is not modified by means of upper-sampling, SMOTE, and other sampling methods to deal with imblanced issue.</p>
            </section>
            <section id="baseline-model-for-comparison" class="level1" data-number="3">
                <h1 data-number="3"><span class="header-section-number">3</span> Baseline model for comparison</h1>
                <div class="cell" data-execution_count="26">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define a baseline model which random assign labels</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> random_classifier(y_data):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    ypred<span class="op">=</span>[]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    max_label<span class="op">=</span>np.<span class="bu">max</span>(y_data)<span class="op">;</span> <span class="co">#print(max_label)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(y_data)):</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        ypred.append(<span class="bu">int</span>(np.floor((max_label<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>))))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"-----RANDOM CLASSIFIER-----"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"accuracy"</span>,accuracy_score(y_data, ypred))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"percision, recall, fscore,"</span>,precision_recall_fscore_support(y_data,ypred))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>random_classifier(df.label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-stdout">
                        <pre><code>-----RANDOM CLASSIFIER-----
accuracy 0.4939145202377583
percision, recall, fscore, (array([0.74219653, 0.25568497]), array([0.48895659, 0.50826902]), array([0.58953168, 0.3402214 ]), array([2626,  907], dtype=int64))</code></pre>
                    </div>
                </div>
                <p>The accuracy for a random classifier is around 0.48, which makes sense to the random guess. The precision score is biased considering the imbalanced data distribution.</p>
            </section>
            <section id="feature-selection" class="level1" data-number="4">
                <h1 data-number="4"><span class="header-section-number">4</span> Feature Selection</h1>
                <div class="cell" data-execution_count="27">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transfer the raw text data into matrix with countVectorizer</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> CountVectorizer(analyzer<span class="op">=</span><span class="st">'word'</span>,min_df<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>content  <span class="op">=</span> df.text</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>vector <span class="op">=</span> cv.fit_transform(content)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> vector.toarray()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>index_name <span class="op">=</span> cv.get_feature_names_out()</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># transfer the vector with tf-idf methods, which is used to give different weights to words in terms of its frequency. Therefore, each words would contribute differently to the outcome. </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>tfidf <span class="op">=</span> TfidfTransformer()</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>x_tf <span class="op">=</span> tfidf.fit_transform(vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>
                <div class="cell" data-execution_count="28">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sm <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>x,y <span class="op">=</span> sm.fit_resample(x_tf, df[<span class="st">'label'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>
                <p>This model try to use texts to classify, so our features are texts transformed by a natural language pipeline, and thereafter using tf-idf to transform the data into matrix.This method is used to give different weights to words in terms
                    of its frequency. Therefore, each words would contribute differently to the outcome.</p>
                <div class="cell" data-execution_count="29">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># train and test</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(x, y, test_size<span class="op">=</span><span class="fl">0.2</span>, stratify<span class="op">=</span>y, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>
            </section>
            <section id="model-tuning" class="level1" data-number="5">
                <h1 data-number="5"><span class="header-section-number">5</span> Model Tuning</h1>
                <div class="cell" data-execution_count="30">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPLETE THE FOLLOWING CODE TO LOOP OVER POSSIBLE HYPER-PARAMETERS VALUES</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>test_results<span class="op">=</span>[]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>train_results<span class="op">=</span>[]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> num_layer <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">20</span>):</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> DecisionTreeClassifier(max_depth<span class="op">=</span>num_layer)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model.fit(X_train,y_train)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    yp_train<span class="op">=</span>model.predict(X_train)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    yp_test<span class="op">=</span>model.predict(X_test)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(y_pred.shape)</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    test_results.append([num_layer,accuracy_score(y_test, yp_test),recall_score(y_test, yp_test,pos_label<span class="op">=</span><span class="dv">0</span>),recall_score(y_test, yp_test,pos_label<span class="op">=</span><span class="dv">1</span>)])</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    train_results.append([num_layer,accuracy_score(y_train, yp_train),recall_score(y_train, yp_train,pos_label<span class="op">=</span><span class="dv">0</span>),recall_score(y_train, yp_train,pos_label<span class="op">=</span><span class="dv">1</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>
                <div class="cell" data-execution_count="31">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>y1_train <span class="op">=</span> [i[<span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> train_results]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y1_test <span class="op">=</span> [i[<span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> test_results]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>y2_train <span class="op">=</span> [i[<span class="dv">2</span>] <span class="cf">for</span> i <span class="kw">in</span> train_results]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>y2_test <span class="op">=</span> [i[<span class="dv">2</span>] <span class="cf">for</span> i <span class="kw">in</span> test_results]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>y3_train <span class="op">=</span> [i[<span class="dv">3</span>] <span class="cf">for</span> i <span class="kw">in</span> train_results]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>y3_test <span class="op">=</span> [i[<span class="dv">3</span>] <span class="cf">for</span> i <span class="kw">in</span> test_results]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>
                <div class="cell" data-execution_count="32">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">20</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>ax.plot(x,y1_train,marker<span class="op">=</span><span class="st">'.'</span>,color<span class="op">=</span><span class="st">'b'</span>,linewidth<span class="op">=</span><span class="fl">2.5</span>,markersize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x,y1_test,color<span class="op">=</span><span class="st">'red'</span>,linewidth<span class="op">=</span><span class="fl">2.5</span>,markersize<span class="op">=</span><span class="dv">20</span>,marker<span class="op">=</span><span class="st">'.'</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of layers in decision tree(max_depth)'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'ACCURACY(Y=0):Training(blue) and Test(red)'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-display">
                        <p><img src="Decision%20Tree_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
                    </div>
                </div>
                <div class="cell" data-execution_count="33">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">20</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ax.plot(x,y2_train,marker<span class="op">=</span><span class="st">'.'</span>,color<span class="op">=</span><span class="st">'b'</span>,linewidth<span class="op">=</span><span class="fl">2.5</span>,markersize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x,y2_test,color<span class="op">=</span><span class="st">'red'</span>,linewidth<span class="op">=</span><span class="fl">2.5</span>,markersize<span class="op">=</span><span class="dv">20</span>,marker<span class="op">=</span><span class="st">'.'</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of layers in decision tree(max_depth)'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'RECALL(Y=0):Training(blue) and Test(red)'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-display">
                        <p><img src="Decision%20Tree_files/figure-html/cell-13-output-1.png" class="img-fluid"></p>
                    </div>
                </div>
                <div class="cell" data-execution_count="34">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">20</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>ax.plot(x,y3_train,marker<span class="op">=</span><span class="st">'.'</span>,color<span class="op">=</span><span class="st">'b'</span>,linewidth<span class="op">=</span><span class="fl">2.5</span>,markersize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x,y3_test,color<span class="op">=</span><span class="st">'red'</span>,linewidth<span class="op">=</span><span class="fl">2.5</span>,markersize<span class="op">=</span><span class="dv">20</span>,marker<span class="op">=</span><span class="st">'.'</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of layers in decision tree(max_depth)'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'RECALL(Y=1):Training(blue) and Test(red)'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plt.xticks(fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>plt.yticks(fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-display">
                        <p><img src="Decision%20Tree_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
                    </div>
                </div>
                <p>After using cross validation, and plotting all the analytical results, we can derive that when the max_depth is 11, the accuracy and recall score is sub-optimal.</p>
            </section>
            <section id="final-results" class="level1" data-number="6">
                <h1 data-number="6"><span class="header-section-number">6</span> Final Results</h1>
                <div class="cell" data-execution_count="35">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> DecisionTreeClassifier(criterion<span class="op">=</span><span class="st">"gini"</span>,max_depth<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>clf.fit(X_train,y_train)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>y_pre <span class="op">=</span> clf.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>
                <div class="cell" data-execution_count="36">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#confusion matrix</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> xticks</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">8</span>))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>mx <span class="op">=</span> confusion_matrix(y_test,y_pre)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># cmd = ConfusionMatrixDisplay(mx,display_labels=['Positive','Negative'])</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>group_names <span class="op">=</span> [<span class="st">'True Neg'</span>,<span class="st">'False Neg'</span>,<span class="st">'False Positive'</span>,<span class="st">'True Positive'</span>]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>group_counts <span class="op">=</span> [<span class="st">"</span><span class="sc">{0:0.0f}</span><span class="st">"</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                mx.flatten()]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>group_percentages <span class="op">=</span> [<span class="st">"</span><span class="sc">{:.2%}</span><span class="st">"</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span> mx.flatten()<span class="op">/</span>np.<span class="bu">sum</span>(mx) ]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f"</span><span class="sc">{</span>v1<span class="sc">}</span><span class="ch">\n</span><span class="sc">{</span>v2<span class="sc">}</span><span class="ch">\n</span><span class="sc">{</span>v3<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> v1, v2, v3 <span class="kw">in</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>          <span class="bu">zip</span>(group_names,group_counts,group_percentages)]</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> np.array(labels).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>sns.heatmap(data<span class="op">=</span>mx,annot<span class="op">=</span>labels,fmt<span class="op">=</span><span class="st">''</span>,cmap<span class="op">=</span><span class="st">'Blues'</span>,square<span class="op">=</span><span class="va">True</span>,annot_kws<span class="op">=</span>{<span class="st">"fontsize"</span>:<span class="dv">14</span>})</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Confusion matrix'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Actual label'</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Predicted label'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels([<span class="st">'Negative'</span>,<span class="st">'Positive'</span>],fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels([<span class="st">'Negative'</span>,<span class="st">'Positive'</span>],fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'./confusion_matrix.png'</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ACCURACY: "</span><span class="op">+</span><span class="bu">str</span>(accuracy_score(y_test,y_pre))<span class="op">+</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span><span class="op">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NEGATIVE RECALL (Y=0): "</span><span class="op">+</span><span class="bu">str</span>(recall_score(y_test,y_pre,pos_label<span class="op">=</span><span class="dv">0</span>))<span class="op">+</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span><span class="op">+</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NEGATIVE PRECISION (Y=0): "</span><span class="op">+</span><span class="bu">str</span>(precision_score(y_test,y_pre,pos_label<span class="op">=</span><span class="dv">0</span>))<span class="op">+</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span><span class="op">+</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"POSITIVE RECALL (Y=1): "</span><span class="op">+</span><span class="bu">str</span>(recall_score(y_test,y_pre,pos_label<span class="op">=</span><span class="dv">1</span>))<span class="op">+</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span><span class="op">+</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"POSITIVE PRECISION (Y=1): "</span><span class="op">+</span><span class="bu">str</span>(precision_score(y_test,y_pre,pos_label<span class="op">=</span><span class="dv">1</span>))<span class="op">+</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co"># from sklearn import tree</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="co"># def plot_tree(model,X,Y):</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     fig = plt.figure(figsize=(25,20))</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     clf = model.fit(X,Y)</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     tree.plot_tree(clf,filled=True)</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="co"># model = tree.DecisionTreeClassifier(criterion="gini",max_depth=11)</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_tree(model,X=X_train,Y=y_train)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-stdout">
                        <pre><code>ACCURACY: 0.6850618458610847
NEGATIVE RECALL (Y=0): 0.9125475285171103
NEGATIVE PRECISION (Y=0): 0.6274509803921569
POSITIVE RECALL (Y=1): 0.45714285714285713
POSITIVE PRECISION (Y=1): 0.8391608391608392
</code></pre>
                    </div>
                    <div class="cell-output cell-output-display">
                        <p><img src="Decision%20Tree_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
                    </div>
                </div>
                <p>Decision Tree is a greedy algorithm, and it means that it can be easily overfitted.Considering choosing the max_depth to be 11, the bias may increase, but the variance is reduced accoriding to the variance and bias trade-off issue.</p>
            </section>
            <section id="conclusion" class="level1" data-number="7">
                <h1 data-number="7"><span class="header-section-number">7</span> Conclusion</h1>
                <p>The final result is shown in the confusion matrix. While the treemap may reflect few useful information since the features contained in a sparse matrix, the confusion matrix do make clear relection of the accuracy and recall rate. The
                    accuracy reaches 0.85, which is a little bit higher than the random classifer. The positive recall rate is pretty terrible.</p>
                <p>In a nutshell, I still need to mine more data to train this classification model, and helpfully, use SMOTE algorithms or lower-sampling methods to deal with imbalanced data.</p>
            </section>

        </main>
        <!-- /main column -->
        <script id="quarto-html-after-body" type="application/javascript">
            window.document.addEventListener("DOMContentLoaded", function(event) {
                const toggleBodyColorMode = (bsSheetEl) => {
                    const mode = bsSheetEl.getAttribute("data-mode");
                    const bodyEl = window.document.querySelector("body");
                    if (mode === "dark") {
                        bodyEl.classList.add("quarto-dark");
                        bodyEl.classList.remove("quarto-light");
                    } else {
                        bodyEl.classList.add("quarto-light");
                        bodyEl.classList.remove("quarto-dark");
                    }
                }
                const toggleBodyColorPrimary = () => {
                    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
                    if (bsSheetEl) {
                        toggleBodyColorMode(bsSheetEl);
                    }
                }
                toggleBodyColorPrimary();
                const icon = "";
                const anchorJS = new window.AnchorJS();
                anchorJS.options = {
                    placement: 'right',
                    icon: icon
                };
                anchorJS.add('.anchored');
                const clipboard = new window.ClipboardJS('.code-copy-button', {
                    target: function(trigger) {
                        return trigger.previousElementSibling;
                    }
                });
                clipboard.on('success', function(e) {
                    // button target
                    const button = e.trigger;
                    // don't keep focus
                    button.blur();
                    // flash "checked"
                    button.classList.add('code-copy-button-checked');
                    var currentTitle = button.getAttribute("title");
                    button.setAttribute("title", "Copied!");
                    let tooltip;
                    if (window.bootstrap) {
                        button.setAttribute("data-bs-toggle", "tooltip");
                        button.setAttribute("data-bs-placement", "left");
                        button.setAttribute("data-bs-title", "Copied!");
                        tooltip = new bootstrap.Tooltip(button, {
                            trigger: "manual",
                            customClass: "code-copy-button-tooltip",
                            offset: [0, -8]
                        });
                        tooltip.show();
                    }
                    setTimeout(function() {
                        if (tooltip) {
                            tooltip.hide();
                            button.removeAttribute("data-bs-title");
                            button.removeAttribute("data-bs-toggle");
                            button.removeAttribute("data-bs-placement");
                        }
                        button.setAttribute("title", currentTitle);
                        button.classList.remove('code-copy-button-checked');
                    }, 1000);
                    // clear code selection
                    e.clearSelection();
                });
                const viewSource = window.document.getElementById('quarto-view-source') ||
                    window.document.getElementById('quarto-code-tools-source');
                if (viewSource) {
                    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
                    viewSource.addEventListener("click", function(e) {
                        if (sourceUrl) {
                            // rstudio viewer pane
                            if (/\bcapabilities=\b/.test(window.location)) {
                                window.open(sourceUrl);
                            } else {
                                window.location.href = sourceUrl;
                            }
                        } else {
                            const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
                            modal.show();
                        }
                        return false;
                    });
                }

                function toggleCodeHandler(show) {
                    return function(e) {
                        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
                        for (let i = 0; i < detailsSrc.length; i++) {
                            const details = detailsSrc[i].parentElement;
                            if (show) {
                                details.open = true;
                            } else {
                                details.removeAttribute("open");
                            }
                        }
                        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
                        const fromCls = show ? "hidden" : "unhidden";
                        const toCls = show ? "unhidden" : "hidden";
                        for (let i = 0; i < cellCodeDivs.length; i++) {
                            const codeDiv = cellCodeDivs[i];
                            if (codeDiv.classList.contains(fromCls)) {
                                codeDiv.classList.remove(fromCls);
                                codeDiv.classList.add(toCls);
                            }
                        }
                        return false;
                    }
                }
                const hideAllCode = window.document.getElementById("quarto-hide-all-code");
                if (hideAllCode) {
                    hideAllCode.addEventListener("click", toggleCodeHandler(false));
                }
                const showAllCode = window.document.getElementById("quarto-show-all-code");
                if (showAllCode) {
                    showAllCode.addEventListener("click", toggleCodeHandler(true));
                }

                function tippyHover(el, contentFn) {
                    const config = {
                        allowHTML: true,
                        content: contentFn,
                        maxWidth: 500,
                        delay: 100,
                        arrow: false,
                        appendTo: function(el) {
                            return el.parentElement;
                        },
                        interactive: true,
                        interactiveBorder: 10,
                        theme: 'quarto',
                        placement: 'bottom-start'
                    };
                    window.tippy(el, config);
                }
                const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
                for (var i = 0; i < noterefs.length; i++) {
                    const ref = noterefs[i];
                    tippyHover(ref, function() {
                        // use id or data attribute instead here
                        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
                        try {
                            href = new URL(href).hash;
                        } catch {}
                        const id = href.replace(/^#\/?/, "");
                        const note = window.document.getElementById(id);
                        return note.innerHTML;
                    });
                }
                const findCites = (el) => {
                    const parentEl = el.parentElement;
                    if (parentEl) {
                        const cites = parentEl.dataset.cites;
                        if (cites) {
                            return {
                                el,
                                cites: cites.split(' ')
                            };
                        } else {
                            return findCites(el.parentElement)
                        }
                    } else {
                        return undefined;
                    }
                };
                var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
                for (var i = 0; i < bibliorefs.length; i++) {
                    const ref = bibliorefs[i];
                    const citeInfo = findCites(ref);
                    if (citeInfo) {
                        tippyHover(citeInfo.el, function() {
                            var popup = window.document.createElement('div');
                            citeInfo.cites.forEach(function(cite) {
                                var citeDiv = window.document.createElement('div');
                                citeDiv.classList.add('hanging-indent');
                                citeDiv.classList.add('csl-entry');
                                var biblioDiv = window.document.getElementById('ref-' + cite);
                                if (biblioDiv) {
                                    citeDiv.innerHTML = biblioDiv.innerHTML;
                                }
                                popup.appendChild(citeDiv);
                            });
                            return popup.innerHTML;
                        });
                    }
                }
            });
        </script>
    </div>
    <!-- /content -->



</body>

</html>