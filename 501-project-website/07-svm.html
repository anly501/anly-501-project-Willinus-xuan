<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.2.247">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Haoxuan(Will) Weng">

    <title>svm</title>
    <link rel="stylesheet" href="./project.css">
    <style>
        code {
            white-space: pre-wrap;
        }
        
        span.smallcaps {
            font-variant: small-caps;
        }
        
        div.columns {
            display: flex;
            gap: min(4vw, 1.5em);
        }
        
        div.column {
            flex: auto;
            overflow-x: auto;
        }
        
        div.hanging-indent {
            margin-left: 1.5em;
            text-indent: -1.5em;
        }
        
        ul.task-list {
            list-style: none;
        }
        
        ul.task-list li input[type="checkbox"] {
            width: 0.8em;
            margin: 0 0.8em 0.2em -1.6em;
            vertical-align: middle;
        }
        
        pre>code.sourceCode {
            white-space: pre;
            position: relative;
        }
        
        pre>code.sourceCode>span {
            display: inline-block;
            line-height: 1.25;
        }
        
        pre>code.sourceCode>span:empty {
            height: 1.2em;
        }
        
        .sourceCode {
            overflow: visible;
        }
        
        code.sourceCode>span {
            color: inherit;
            text-decoration: inherit;
        }
        
        div.sourceCode {
            margin: 1em 0;
        }
        
        pre.sourceCode {
            margin: 0;
        }
        
        @media screen {
            div.sourceCode {
                overflow: auto;
            }
        }
        
        @media print {
            pre>code.sourceCode {
                white-space: pre-wrap;
            }
            pre>code.sourceCode>span {
                text-indent: -5em;
                padding-left: 5em;
            }
        }
        
        pre.numberSource code {
            counter-reset: source-line 0;
        }
        
        pre.numberSource code>span {
            position: relative;
            left: -4em;
            counter-increment: source-line;
        }
        
        pre.numberSource code>span>a:first-child::before {
            content: counter(source-line);
            position: relative;
            left: -1em;
            text-align: right;
            vertical-align: baseline;
            border: none;
            display: inline-block;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            padding: 0 4px;
            width: 4em;
            color: #aaaaaa;
        }
        
        pre.numberSource {
            margin-left: 3em;
            border-left: 1px solid #aaaaaa;
            padding-left: 4px;
        }
        
        div.sourceCode {}
        
        @media screen {
            pre>code.sourceCode>span>a:first-child::before {
                text-decoration: underline;
            }
        }
        
        code span.al {
            color: #ff0000;
            font-weight: bold;
        }
        /* Alert */
        
        code span.an {
            color: #60a0b0;
            font-weight: bold;
            font-style: italic;
        }
        /* Annotation */
        
        code span.at {
            color: #7d9029;
        }
        /* Attribute */
        
        code span.bn {
            color: #40a070;
        }
        /* BaseN */
        
        code span.bu {
            color: #008000;
        }
        /* BuiltIn */
        
        code span.cf {
            color: #007020;
            font-weight: bold;
        }
        /* ControlFlow */
        
        code span.ch {
            color: #4070a0;
        }
        /* Char */
        
        code span.cn {
            color: #880000;
        }
        /* Constant */
        
        code span.co {
            color: #60a0b0;
            font-style: italic;
        }
        /* Comment */
        
        code span.cv {
            color: #60a0b0;
            font-weight: bold;
            font-style: italic;
        }
        /* CommentVar */
        
        code span.do {
            color: #ba2121;
            font-style: italic;
        }
        /* Documentation */
        
        code span.dt {
            color: #902000;
        }
        /* DataType */
        
        code span.dv {
            color: #40a070;
        }
        /* DecVal */
        
        code span.er {
            color: #ff0000;
            font-weight: bold;
        }
        /* Error */
        
        code span.ex {}
        /* Extension */
        
        code span.fl {
            color: #40a070;
        }
        /* Float */
        
        code span.fu {
            color: #06287e;
        }
        /* Function */
        
        code span.im {
            color: #008000;
            font-weight: bold;
        }
        /* Import */
        
        code span.in {
            color: #60a0b0;
            font-weight: bold;
            font-style: italic;
        }
        /* Information */
        
        code span.kw {
            color: #007020;
            font-weight: bold;
        }
        /* Keyword */
        
        code span.op {
            color: #666666;
        }
        /* Operator */
        
        code span.ot {
            color: #007020;
        }
        /* Other */
        
        code span.pp {
            color: #bc7a00;
        }
        /* Preprocessor */
        
        code span.sc {
            color: #4070a0;
        }
        /* SpecialChar */
        
        code span.ss {
            color: #bb6688;
        }
        /* SpecialString */
        
        code span.st {
            color: #4070a0;
        }
        /* String */
        
        code span.va {
            color: #19177c;
        }
        /* Variable */
        
        code span.vs {
            color: #4070a0;
        }
        /* VerbatimString */
        
        code span.wa {
            color: #60a0b0;
            font-weight: bold;
            font-style: italic;
        }
        /* Warning */
    </style>


    <script src="svm_files/libs/clipboard/clipboard.min.js"></script>
    <script src="svm_files/libs/quarto-html/quarto.js"></script>
    <script src="svm_files/libs/quarto-html/popper.min.js"></script>
    <script src="svm_files/libs/quarto-html/tippy.umd.min.js"></script>
    <script src="svm_files/libs/quarto-html/anchor.min.js"></script>
    <link href="svm_files/libs/quarto-html/tippy.css" rel="stylesheet">
    <link href="svm_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
    <script src="svm_files/libs/bootstrap/bootstrap.min.js"></script>
    <link href="svm_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
    <link href="svm_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
    <script type="application/javascript">
        define('jquery', [], function() {
            return window.jQuery;
        })
    </script>


</head>

<body>
    <header>
        <div class="su-brand-bar su-brand-bar--default">
            <div class="header-container">
                <div class="header-leftside">
                    <a class="su-brand-bar__logo" href="https://www.georgetown.edu/">Georgetown University</a>
                </div>

                <div class="header-rightside">
                    <a class="su-brand-bar__logo" href="http://haoxuan-weng.georgetown.domains/501-project-website/index.html">
            Home
        </a>
                    <a class="su-brand-bar__logo code" href="https://github.com/anly501/anly-501-project-Willinus-xuan">
            Code
        </a>
                    <a class="su-brand-bar__logo code" href="https://github.com/anly501/anly-501-project-Willinus-xuan">
            Data
        </a>
                </div>
            </div>
        </div>
    </header>

    <section class="banner">
        <div class="content-container">
            <div class='research-name'>
                <h1>
                    Automatic Cyberbulleying detect
                </h1>
            </div>
            <div class="subject">
                ANLY 501 Data Science and Analytics
            </div>
        </div>
    </section>

    <section class="wrapper">
        <div style="position:sticky;top: 300px;float: left;max-width: 25%;">
            <nav class="bx--tableofcontents__desktop" data-autoid="dds--tableofcontents__desktop">
                <ul>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/01-introduction.html">About this project</a></li>
                    <li class="bx--tableofcontents__desktop__item bx--tableofcontents__desktop__item--active"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/02-data_collection.html" aria-current="location">Data collection</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/03-data_cleaning.html">Data Cleaning</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/04-data_exploring.html">Exploring Data</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/05-Naive_Bayes.html">Naïve Bayes</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/06-Decision_tree.html">Decision Trees</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/07-svm.html">SVM</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/08-clustering_analysis.html">Clustering</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/09-network_analysis.html">ARM and Networking</a></li>
                    <li class="bx--tableofcontents__desktop__item"><a href="http://haoxuan-weng.georgetown.domains/501-project-website/10-conclusion.html">Conclusions</a></li>
                </ul>
            </nav>
        </div>
    </section>
    <div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
        <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
            <nav id="TOC" role="doc-toc" class="toc-active">
                <h2 id="toc-title">Table of contents</h2>

                <ul>
                    <li><a href="#method" id="toc-method" class="nav-link active" data-scroll-target="#method"><span class="toc-section-number">1</span>  Method</a></li>
                    <li><a href="#class-distribution" id="toc-class-distribution" class="nav-link" data-scroll-target="#class-distribution"><span class="toc-section-number">2</span>  Class distribution</a></li>
                    <li><a href="#baseline-model-for-comparison" id="toc-baseline-model-for-comparison" class="nav-link" data-scroll-target="#baseline-model-for-comparison"><span class="toc-section-number">3</span>  Baseline model for comparison</a></li>
                    <li><a href="#feature-engineering" id="toc-feature-engineering" class="nav-link" data-scroll-target="#feature-engineering"><span class="toc-section-number">4</span>  Feature Engineering</a></li>
                    <li><a href="#model-tuning" id="toc-model-tuning" class="nav-link" data-scroll-target="#model-tuning"><span class="toc-section-number">5</span>  Model Tuning</a></li>
                    <li><a href="#final-result" id="toc-final-result" class="nav-link" data-scroll-target="#final-result"><span class="toc-section-number">6</span>  Final Result</a></li>
                    <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="toc-section-number">7</span>  Conclusion</a></li>
                </ul>
            </nav>
        </div>
        <main class="content" id="quarto-document-content">



            <section id="method" class="level1" data-number="1">
                <h1 data-number="1"><span class="header-section-number">1</span> Method</h1>
                <p>A Support Vector Machine (SVM) is a supervised machine learning algorithm that can be employed for both classification and regression purposes. SVMs are more commonly used in classification problems and as such, this is what we will focus
                    on in this post.</p>
                <p>SVMs are based on the idea of finding a hyperplane that best divides a dataset into two classes, as shown in the image below.</p>
                <p><img src="https://s2.loli.net/2022/10/29/Qs9duYNAlkJLWyj.png"></p>
                <div class="cell" data-execution_count="1">
                    <details>

                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import all the required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, ConfusionMatrixDisplay</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_recall_fscore_support</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> recall_score</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> f1_score</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>

                <div class="cell" data-execution_count="3">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the csv file</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'../../data/hate_speech.csv'</span>,index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># only use the numerical data to predict the y variable</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.loc[:,[<span class="st">'id'</span>,<span class="st">'follower_count'</span>,<span class="st">'friends_count'</span>,<span class="st">'retweet_count'</span>,<span class="st">'favorite_count'</span>,<span class="st">'word_length'</span>,<span class="st">'label'</span>]]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-display" data-execution_count="3">

                        <div>

                            <table class="dataframe table table-sm table-striped">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th>id</th>
                                        <th>follower_count</th>
                                        <th>friends_count</th>
                                        <th>retweet_count</th>
                                        <th>favorite_count</th>
                                        <th>word_length</th>
                                        <th>label</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th>0</th>
                                        <td>13857342</td>
                                        <td>20161</td>
                                        <td>780</td>
                                        <td>0</td>
                                        <td>0</td>
                                        <td>10</td>
                                        <td>0</td>
                                    </tr>
                                    <tr>
                                        <th>1</th>
                                        <td>13857342</td>
                                        <td>20161</td>
                                        <td>780</td>
                                        <td>0</td>
                                        <td>4</td>
                                        <td>13</td>
                                        <td>0</td>
                                    </tr>
                                    <tr>
                                        <th>2</th>
                                        <td>82522377</td>
                                        <td>4</td>
                                        <td>64</td>
                                        <td>0</td>
                                        <td>1</td>
                                        <td>15</td>
                                        <td>1</td>
                                    </tr>
                                    <tr>
                                        <th>3</th>
                                        <td>13857342</td>
                                        <td>20161</td>
                                        <td>780</td>
                                        <td>1</td>
                                        <td>30</td>
                                        <td>11</td>
                                        <td>0</td>
                                    </tr>
                                    <tr>
                                        <th>4</th>
                                        <td>930620467</td>
                                        <td>18807</td>
                                        <td>263</td>
                                        <td>0</td>
                                        <td>0</td>
                                        <td>11</td>
                                        <td>0</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>
            <section id="class-distribution" class="level1" data-number="2">
                <h1 data-number="2"><span class="header-section-number">2</span> Class distribution</h1>
                <div class="cell" data-execution_count="4">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the distribution</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.hist(df.label.astype(<span class="st">'string'</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"The distribution of the class"</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Class"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Counts"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-display" data-execution_count="4">
                        <pre><code>Text(0, 0.5, 'Counts')</code></pre>
                    </div>
                    <div class="cell-output cell-output-display">
                        <p><img src="svm_files/figure-html/cell-5-output-2.png" class="img-fluid"></p>
                    </div>
                </div>
                <p>The counts of the two classes are imblanced. The labels are binary value. In order to maintain the original imblanced distribution of the two classes, the dataset is not modified by means of upper-sampling, SMOTE, and other sampling methods
                    to deal with imblanced issue.</p>
            </section>
            <section id="baseline-model-for-comparison" class="level1" data-number="3">
                <h1 data-number="3"><span class="header-section-number">3</span> Baseline model for comparison</h1>
                <div class="cell" data-execution_count="5">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define a baseline model which random assign labels</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> random_classifier(y_data):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    ypred<span class="op">=</span>[]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    max_label<span class="op">=</span>np.<span class="bu">max</span>(y_data)<span class="op">;</span> <span class="co">#print(max_label)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(y_data)):</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        ypred.append(<span class="bu">int</span>(np.floor((max_label<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>))))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"-----RANDOM CLASSIFIER-----"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"accuracy"</span>,accuracy_score(y_data, ypred))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"percision, recall, fscore,"</span>,precision_recall_fscore_support(y_data,ypred))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>random_classifier(df.label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-stdout">
                        <pre><code>-----RANDOM CLASSIFIER-----
accuracy 0.5069346164732522
percision, recall, fscore, (array([0.7458287 , 0.25936599]), array([0.5106626 , 0.49614112]), array([0.6062387 , 0.34065102]), array([2626,  907], dtype=int64))</code></pre>
                    </div>
                </div>
                <p>The accuracy for a random classifier is around 0.5, which makes sense to the random guess. The precision score is biased considering the imbalanced data distribution.</p>
            </section>
            <section id="feature-engineering" class="level1" data-number="4">
                <h1 data-number="4"><span class="header-section-number">4</span> Feature Engineering</h1>
                <div class="cell" data-execution_count="6">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df.drop(<span class="st">'label'</span>,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df.label</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>sm <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>x_smote,y_smote <span class="op">=</span> sm.fit_resample(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>
                <div class="cell" data-execution_count="8">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize all the data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> preprocessing.StandardScaler()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(x_smote)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># split the data into train,test data set</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y_smote, test_size<span class="op">=</span><span class="fl">0.2</span>, stratify <span class="op">=</span> y_smote, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>
                <p>Overall, we select 5 numerical variable to represent the record data, and further leverage it to predict the text data.</p>
            </section>
            <section id="model-tuning" class="level1" data-number="5">
                <h1 data-number="5"><span class="header-section-number">5</span> Model Tuning</h1>
                <p>SVM calculate distance, therefore by normalizing the data, we can train our model much faster. Besides, hyperparemeter is significant to train a sub-optimal classification model. In this case, I leverage grid search to find out the best
                    paremeter for my svm model.</p>
                <div class="cell" data-execution_count="9">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#find the best hyperparametres with GridSearchCV library</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>parameter<span class="op">=</span>[</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"C"</span>:[<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>],<span class="st">"kernel"</span>:[<span class="st">"linear"</span>]},</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"C"</span>:[<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>],<span class="st">"kernel"</span>:[<span class="st">"rbf"</span>],<span class="st">"gamma"</span>:[<span class="fl">0.1</span>,<span class="fl">.3</span>,<span class="fl">.5</span>,<span class="fl">.7</span>,<span class="fl">.9</span>]}</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(SVC(), param_grid<span class="op">=</span>parameter, scoring<span class="op">=</span><span class="st">"accuracy"</span>,cv<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>grid_search<span class="op">=</span>grid_search.fit(X_train, y_train)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The best hyperparametres are:"</span>,grid_search.best_params_)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>grid_search</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-stdout">
                        <pre><code>The best hyperparametres are: {'C': 100, 'gamma': 0.9, 'kernel': 'rbf'}</code></pre>
                    </div>
                    <div class="cell-output cell-output-display" data-execution_count="9">
                        <style>
                            #sk-container-id-1 {
                                color: black;
                                background-color: white;
                            }
                            
                            #sk-container-id-1 pre {
                                padding: 0;
                            }
                            
                            #sk-container-id-1 div.sk-toggleable {
                                background-color: white;
                            }
                            
                            #sk-container-id-1 label.sk-toggleable__label {
                                cursor: pointer;
                                display: block;
                                width: 100%;
                                margin-bottom: 0;
                                padding: 0.3em;
                                box-sizing: border-box;
                                text-align: center;
                            }
                            
                            #sk-container-id-1 label.sk-toggleable__label-arrow:before {
                                content: "▸";
                                float: left;
                                margin-right: 0.25em;
                                color: #696969;
                            }
                            
                            #sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
                                color: black;
                            }
                            
                            #sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {
                                color: black;
                            }
                            
                            #sk-container-id-1 div.sk-toggleable__content {
                                max-height: 0;
                                max-width: 0;
                                overflow: hidden;
                                text-align: left;
                                background-color: #f0f8ff;
                            }
                            
                            #sk-container-id-1 div.sk-toggleable__content pre {
                                margin: 0.2em;
                                color: black;
                                border-radius: 0.25em;
                                background-color: #f0f8ff;
                            }
                            
                            #sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
                                max-height: 200px;
                                max-width: 100%;
                                overflow: auto;
                            }
                            
                            #sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
                                content: "▾";
                            }
                            
                            #sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
                                background-color: #d4ebff;
                            }
                            
                            #sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
                                background-color: #d4ebff;
                            }
                            
                            #sk-container-id-1 input.sk-hidden--visually {
                                border: 0;
                                clip: rect(1px 1px 1px 1px);
                                clip: rect(1px, 1px, 1px, 1px);
                                height: 1px;
                                margin: -1px;
                                overflow: hidden;
                                padding: 0;
                                position: absolute;
                                width: 1px;
                            }
                            
                            #sk-container-id-1 div.sk-estimator {
                                font-family: monospace;
                                background-color: #f0f8ff;
                                border: 1px dotted black;
                                border-radius: 0.25em;
                                box-sizing: border-box;
                                margin-bottom: 0.5em;
                            }
                            
                            #sk-container-id-1 div.sk-estimator:hover {
                                background-color: #d4ebff;
                            }
                            
                            #sk-container-id-1 div.sk-parallel-item::after {
                                content: "";
                                width: 100%;
                                border-bottom: 1px solid gray;
                                flex-grow: 1;
                            }
                            
                            #sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
                                background-color: #d4ebff;
                            }
                            
                            #sk-container-id-1 div.sk-serial::before {
                                content: "";
                                position: absolute;
                                border-left: 1px solid gray;
                                box-sizing: border-box;
                                top: 0;
                                bottom: 0;
                                left: 50%;
                                z-index: 0;
                            }
                            
                            #sk-container-id-1 div.sk-serial {
                                display: flex;
                                flex-direction: column;
                                align-items: center;
                                background-color: white;
                                padding-right: 0.2em;
                                padding-left: 0.2em;
                                position: relative;
                            }
                            
                            #sk-container-id-1 div.sk-item {
                                position: relative;
                                z-index: 1;
                            }
                            
                            #sk-container-id-1 div.sk-parallel {
                                display: flex;
                                align-items: stretch;
                                justify-content: center;
                                background-color: white;
                                position: relative;
                            }
                            
                            #sk-container-id-1 div.sk-item::before,
                            #sk-container-id-1 div.sk-parallel-item::before {
                                content: "";
                                position: absolute;
                                border-left: 1px solid gray;
                                box-sizing: border-box;
                                top: 0;
                                bottom: 0;
                                left: 50%;
                                z-index: -1;
                            }
                            
                            #sk-container-id-1 div.sk-parallel-item {
                                display: flex;
                                flex-direction: column;
                                z-index: 1;
                                position: relative;
                                background-color: white;
                            }
                            
                            #sk-container-id-1 div.sk-parallel-item:first-child::after {
                                align-self: flex-end;
                                width: 50%;
                            }
                            
                            #sk-container-id-1 div.sk-parallel-item:last-child::after {
                                align-self: flex-start;
                                width: 50%;
                            }
                            
                            #sk-container-id-1 div.sk-parallel-item:only-child::after {
                                width: 0;
                            }
                            
                            #sk-container-id-1 div.sk-dashed-wrapped {
                                border: 1px dashed gray;
                                margin: 0 0.4em 0.5em 0.4em;
                                box-sizing: border-box;
                                padding-bottom: 0.4em;
                                background-color: white;
                            }
                            
                            #sk-container-id-1 div.sk-label label {
                                font-family: monospace;
                                font-weight: bold;
                                display: inline-block;
                                line-height: 1.2em;
                            }
                            
                            #sk-container-id-1 div.sk-label-container {
                                text-align: center;
                            }
                            
                            #sk-container-id-1 div.sk-container {
                                /* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
                                display: inline-block !important;
                                position: relative;
                            }
                            
                            #sk-container-id-1 div.sk-text-repr-fallback {
                                display: none;
                            }
                        </style>
                        <div id="sk-container-id-1" class="sk-top-container">
                            <div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=10, estimator=SVC(),
             param_grid=[{'C': [1, 10, 100], 'kernel': ['linear']},
                         {'C': [1, 10, 100], 'gamma': [0.1, 0.3, 0.5, 0.7, 0.9],
                          'kernel': ['rbf']}],
             scoring='accuracy')</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div>
                            <div class="sk-container" hidden="">
                                <div class="sk-item sk-dashed-wrapped">
                                    <div class="sk-label-container">
                                        <div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label>
                                            <div class="sk-toggleable__content"><pre>GridSearchCV(cv=10, estimator=SVC(),
             param_grid=[{'C': [1, 10, 100], 'kernel': ['linear']},
                         {'C': [1, 10, 100], 'gamma': [0.1, 0.3, 0.5, 0.7, 0.9],
                          'kernel': ['rbf']}],
             scoring='accuracy')</pre></div>
                                        </div>
                                    </div>
                                    <div class="sk-parallel">
                                        <div class="sk-parallel-item">
                                            <div class="sk-item">
                                                <div class="sk-label-container">
                                                    <div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: SVC</label>
                                                        <div class="sk-toggleable__content"><pre>SVC()</pre></div>
                                                    </div>
                                                </div>
                                                <div class="sk-serial">
                                                    <div class="sk-item">
                                                        <div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label>
                                                            <div class="sk-toggleable__content"><pre>SVC()</pre></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <p>In this part, we use “GridSearchCV” function to help us find the beset parametres so that we don’t need to write codes and make some loops manually. The result shows that <strong>we should use rbf kernel and should set C as 100, and the gamma should be 0.9</strong>.</p>
            </section>
            <section id="final-result" class="level1" data-number="6">
                <h1 data-number="6"><span class="header-section-number">6</span> Final Result</h1>
                <div class="cell" data-execution_count="10">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit the model with the best hyperparametres</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>clf<span class="op">=</span>SVC(C<span class="op">=</span><span class="dv">100</span>,kernel<span class="op">=</span><span class="st">"rbf"</span>,gamma<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>clf.fit(X_train,y_train)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>y_pre<span class="op">=</span>clf.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                </div>
                <div class="cell" data-execution_count="11">
                    <details>
                        <summary>Code</summary>
                        <div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">8</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>mx <span class="op">=</span> confusion_matrix(y_test,y_pre)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cmd = ConfusionMatrixDisplay(mx,display_labels=['Positive','Negative'])</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>group_names <span class="op">=</span> [<span class="st">'True Neg'</span>,<span class="st">'False Neg'</span>,<span class="st">'False Positive'</span>,<span class="st">'True Positive'</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>group_counts <span class="op">=</span> [<span class="st">"</span><span class="sc">{0:0.0f}</span><span class="st">"</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                mx.flatten()]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>group_percentages <span class="op">=</span> [<span class="st">"</span><span class="sc">{:.2%}</span><span class="st">"</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span> mx.flatten()<span class="op">/</span>np.<span class="bu">sum</span>(mx) ]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f"</span><span class="sc">{</span>v1<span class="sc">}</span><span class="ch">\n</span><span class="sc">{</span>v2<span class="sc">}</span><span class="ch">\n</span><span class="sc">{</span>v3<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> v1, v2, v3 <span class="kw">in</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>          <span class="bu">zip</span>(group_names,group_counts,group_percentages)]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> np.array(labels).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>sns.heatmap(data<span class="op">=</span>mx,annot<span class="op">=</span>labels,fmt<span class="op">=</span><span class="st">''</span>,cmap<span class="op">=</span><span class="st">'Blues'</span>,square<span class="op">=</span><span class="va">True</span>,annot_kws<span class="op">=</span>{<span class="st">"fontsize"</span>:<span class="dv">14</span>})</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Confusion matrix'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Actual label'</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Predicted label'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels([<span class="st">'Negative'</span>,<span class="st">'Positive'</span>],fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels([<span class="st">'Negative'</span>,<span class="st">'Positive'</span>],fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'./confusion_matrix.png'</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ACCURACY: "</span><span class="op">+</span><span class="bu">str</span>(accuracy_score(y_test,y_pre))<span class="op">+</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span><span class="op">+</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NEGATIVE RECALL (Y=0): "</span><span class="op">+</span><span class="bu">str</span>(recall_score(y_test,y_pre,pos_label<span class="op">=</span><span class="dv">0</span>))<span class="op">+</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span><span class="op">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NEGATIVE PRECISION (Y=0): "</span><span class="op">+</span><span class="bu">str</span>(precision_score(y_test,y_pre,pos_label<span class="op">=</span><span class="dv">0</span>))<span class="op">+</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span><span class="op">+</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"POSITIVE RECALL (Y=1): "</span><span class="op">+</span><span class="bu">str</span>(recall_score(y_test,y_pre,pos_label<span class="op">=</span><span class="dv">1</span>))<span class="op">+</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span><span class="op">+</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"POSITIVE PRECISION (Y=1): "</span><span class="op">+</span><span class="bu">str</span>(precision_score(y_test,y_pre,pos_label<span class="op">=</span><span class="dv">1</span>))<span class="op">+</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </details>
                    <div class="cell-output cell-output-stdout">
                        <pre><code>ACCURACY: 0.6917221693625119
NEGATIVE RECALL (Y=0): 0.6539923954372624
NEGATIVE PRECISION (Y=0): 0.7078189300411523
POSITIVE RECALL (Y=1): 0.7295238095238096
POSITIVE PRECISION (Y=1): 0.6778761061946903
</code></pre>
                    </div>
                    <div class="cell-output cell-output-display">
                        <p><img src="svm_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
                    </div>
                </div>
                <p>It seems that we have used the best paremeter, the recall and precision rate for this classification model reaches 70% around, which is better than a random classifier.</p>
            </section>
            <section id="conclusion" class="level1" data-number="7">
                <h1 data-number="7"><span class="header-section-number">7</span> Conclusion</h1>
                <p>In this tab, we leverage SVM to solve the problems. The accuracy score shows that it is higher than the model we ouput with decision tree. But overall, it should still weak than the ensemble model, using random forest, or other boosting
                    ensemble model such as XGboost.</p>
            </section>

        </main>
        <!-- /main column -->
        <script id="quarto-html-after-body" type="application/javascript">
            window.document.addEventListener("DOMContentLoaded", function(event) {
                const toggleBodyColorMode = (bsSheetEl) => {
                    const mode = bsSheetEl.getAttribute("data-mode");
                    const bodyEl = window.document.querySelector("body");
                    if (mode === "dark") {
                        bodyEl.classList.add("quarto-dark");
                        bodyEl.classList.remove("quarto-light");
                    } else {
                        bodyEl.classList.add("quarto-light");
                        bodyEl.classList.remove("quarto-dark");
                    }
                }
                const toggleBodyColorPrimary = () => {
                    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
                    if (bsSheetEl) {
                        toggleBodyColorMode(bsSheetEl);
                    }
                }
                toggleBodyColorPrimary();
                const icon = "";
                const anchorJS = new window.AnchorJS();
                anchorJS.options = {
                    placement: 'right',
                    icon: icon
                };
                anchorJS.add('.anchored');
                const clipboard = new window.ClipboardJS('.code-copy-button', {
                    target: function(trigger) {
                        return trigger.previousElementSibling;
                    }
                });
                clipboard.on('success', function(e) {
                    // button target
                    const button = e.trigger;
                    // don't keep focus
                    button.blur();
                    // flash "checked"
                    button.classList.add('code-copy-button-checked');
                    var currentTitle = button.getAttribute("title");
                    button.setAttribute("title", "Copied!");
                    let tooltip;
                    if (window.bootstrap) {
                        button.setAttribute("data-bs-toggle", "tooltip");
                        button.setAttribute("data-bs-placement", "left");
                        button.setAttribute("data-bs-title", "Copied!");
                        tooltip = new bootstrap.Tooltip(button, {
                            trigger: "manual",
                            customClass: "code-copy-button-tooltip",
                            offset: [0, -8]
                        });
                        tooltip.show();
                    }
                    setTimeout(function() {
                        if (tooltip) {
                            tooltip.hide();
                            button.removeAttribute("data-bs-title");
                            button.removeAttribute("data-bs-toggle");
                            button.removeAttribute("data-bs-placement");
                        }
                        button.setAttribute("title", currentTitle);
                        button.classList.remove('code-copy-button-checked');
                    }, 1000);
                    // clear code selection
                    e.clearSelection();
                });
                const viewSource = window.document.getElementById('quarto-view-source') ||
                    window.document.getElementById('quarto-code-tools-source');
                if (viewSource) {
                    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
                    viewSource.addEventListener("click", function(e) {
                        if (sourceUrl) {
                            // rstudio viewer pane
                            if (/\bcapabilities=\b/.test(window.location)) {
                                window.open(sourceUrl);
                            } else {
                                window.location.href = sourceUrl;
                            }
                        } else {
                            const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
                            modal.show();
                        }
                        return false;
                    });
                }

                function toggleCodeHandler(show) {
                    return function(e) {
                        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
                        for (let i = 0; i < detailsSrc.length; i++) {
                            const details = detailsSrc[i].parentElement;
                            if (show) {
                                details.open = true;
                            } else {
                                details.removeAttribute("open");
                            }
                        }
                        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
                        const fromCls = show ? "hidden" : "unhidden";
                        const toCls = show ? "unhidden" : "hidden";
                        for (let i = 0; i < cellCodeDivs.length; i++) {
                            const codeDiv = cellCodeDivs[i];
                            if (codeDiv.classList.contains(fromCls)) {
                                codeDiv.classList.remove(fromCls);
                                codeDiv.classList.add(toCls);
                            }
                        }
                        return false;
                    }
                }
                const hideAllCode = window.document.getElementById("quarto-hide-all-code");
                if (hideAllCode) {
                    hideAllCode.addEventListener("click", toggleCodeHandler(false));
                }
                const showAllCode = window.document.getElementById("quarto-show-all-code");
                if (showAllCode) {
                    showAllCode.addEventListener("click", toggleCodeHandler(true));
                }

                function tippyHover(el, contentFn) {
                    const config = {
                        allowHTML: true,
                        content: contentFn,
                        maxWidth: 500,
                        delay: 100,
                        arrow: false,
                        appendTo: function(el) {
                            return el.parentElement;
                        },
                        interactive: true,
                        interactiveBorder: 10,
                        theme: 'quarto',
                        placement: 'bottom-start'
                    };
                    window.tippy(el, config);
                }
                const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
                for (var i = 0; i < noterefs.length; i++) {
                    const ref = noterefs[i];
                    tippyHover(ref, function() {
                        // use id or data attribute instead here
                        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
                        try {
                            href = new URL(href).hash;
                        } catch {}
                        const id = href.replace(/^#\/?/, "");
                        const note = window.document.getElementById(id);
                        return note.innerHTML;
                    });
                }
                const findCites = (el) => {
                    const parentEl = el.parentElement;
                    if (parentEl) {
                        const cites = parentEl.dataset.cites;
                        if (cites) {
                            return {
                                el,
                                cites: cites.split(' ')
                            };
                        } else {
                            return findCites(el.parentElement)
                        }
                    } else {
                        return undefined;
                    }
                };
                var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
                for (var i = 0; i < bibliorefs.length; i++) {
                    const ref = bibliorefs[i];
                    const citeInfo = findCites(ref);
                    if (citeInfo) {
                        tippyHover(citeInfo.el, function() {
                            var popup = window.document.createElement('div');
                            citeInfo.cites.forEach(function(cite) {
                                var citeDiv = window.document.createElement('div');
                                citeDiv.classList.add('hanging-indent');
                                citeDiv.classList.add('csl-entry');
                                var biblioDiv = window.document.getElementById('ref-' + cite);
                                if (biblioDiv) {
                                    citeDiv.innerHTML = biblioDiv.innerHTML;
                                }
                                popup.appendChild(citeDiv);
                            });
                            return popup.innerHTML;
                        });
                    }
                }
            });
        </script>
    </div>
    <!-- /content -->



</body>

</html>